<?xml version="1.0" encoding="UTF-8"?>
<!-- This assumes that the build file is in the same directory as the project -->
<project name="test-ant" default="scan" basedir=".">
  <!-- 1. These are the definitions needed to run Sierra.
  
          You need to change sl.home to match where you've 
          unzipped sierra-ant.zip
    -->
  <property name="sl.home" value="c:/work/workspace/sierra-ant" />
  <property name="sl.lib" value="${sl.home}/lib" />
  <property name="project" value="tomcat"/>
  
  <path id="sl.classpath">
      <fileset dir="${sl.lib}" includes="**/*.jar"/>
  </path>

  <taskdef resource="com/surelogic/ant/sierra/ant.properties">
      <classpath refid="sl.classpath"/>
  </taskdef>
  
  <!-- 2. These are jars used to compile (and thus scan) Tomcat 
      
          They are defined here to simplify the classpath property
          for the sierra-scan task below
  -->
  <property name="wsdl.lib" value="${basedir}/repository/wsdl4j-1.5.1.jar"/>
  <property name="jax.lib" value="${basedir}/repository/jaxrpc.jar"/>
  <property name="jdt.plugin" value="${basedir}/repository/eclipse/plugins/org.eclipse.jdt.core_3.2.3.v_686_R32x.jar"/>
  <property name="ant.plugin" value="${basedir}/repository/eclipse/plugins/org.apache.ant_1.6.5/lib/ant.jar"/>

  <!-- Sets the standard DSTAMP, TSTAMP, and TODAY properties -->
  <tstamp/>
  
	<target name="scan">	  	  
	  <property name="document" value="${project}-${DSTAMP}${TSTAMP}" />
	
	  <!-- 3. Change the properties for the sierra-scan task to match your
	          Java project, in particular, srcdir, excludes, destdir, and classpath.
	  
	          Since sierra-scan uses many of the same properties as the javac task,
            you could copy these from an existing Ant build file.	     
            
            Note that the scan document is created in the current directory, 
            i.e. ${basedir}     
	  -->
	  <sierra-scan 
	       srcdir="${basedir}/java;${basedir}/webapps/examples/WEB-INF/classes"
	       excludes="**/.svn/**,org/apache/tomcat/util/net/puretls/**"
         destdir="${basedir}/.settings/output"
         classpath="${wsdl.lib};${jax.lib};${jdt.plugin};${ant.plugin}"
         source="1.5"
         home="${sl.home}"
         document="tomcat6-${DSTAMP}${TSTAMP}"
	       projectname="tomcat6">
    </sierra-scan>
    <!-- 4. Change the properties for the sierra-publish task to match the
	          settings for your team server.
	     
	          If you are running the local team server, you should only need
	          to update the user and password. 
	  -->
	  <sierra-publish 
         user="zork"
         password="zork"
         host="localhost"
	       secure="false"
	       port="13376"
	       contextPath="/sl/"
         document="${document}"
	  />
	</target>
</project>