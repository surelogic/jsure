<?xml version="1.0" encoding="UTF-8"?>
<project default="fresh-javadoc">

	<property name="build" location="${basedir}/build" />
	<property name="build-x" location="${basedir}/build-x" />

	<property name="production-promises" location="${basedir}/../promises/" />

	<target name="clean">
		<delete quiet="true" dir="${build}" />
		<delete quiet="true" dir="${build-x}" />
	</target>

	<target name="setup">
		<mkdir dir="${build}/bin" />
		<mkdir dir="${build-x}/bin" />
	</target>

	<target name="build" depends="setup">
		<javac srcdir="${production-promises}/src/main/java" destdir="${build}/bin" classpath="." debug="on" source="1.5" />
		<jar destfile="${build}/promises.jar">
			<fileset dir="${build}/bin" />
			<manifest />
		</jar>
	</target>

	<target name="src" depends="build">
		<jar destfile="${build}/promises.jar" update="true">
			<fileset dir="${production-promises}/src/main/java">
				<filename name="**/*.java" />
			</fileset>
			<manifest />
		</jar>
	</target>


	<target name="build-x" depends="setup">
		<javac srcdir="${basedir}/src:${production-promises}/src/main/java" destdir="${build-x}/bin" classpath="." debug="on" source="1.5" />
		<jar destfile="${build-x}/promises.jar">
			<fileset dir="${build-x}/bin" />
			<manifest />
		</jar>
	</target>

	<target name="src-x" depends="build-x">
		<jar destfile="${build-x}/promises.jar" update="true">
			<fileset dir="${basedir}/src">
				<filename name="**/*.java" />
			</fileset>
			<fileset dir="${production-promises}/src/main/java">
				<filename name="**/*.java" />
			</fileset>
			<manifest />
		</jar>
	</target>


	<target name="javadoc" depends="src">
		<javadoc access="public" author="true" classpath="." destdir="${build}/javadoc" nodeprecated="false" nodeprecatedlist="false" noindex="false" nonavbar="false" notree="false" packagenames="com.surelogic" source="1.5" sourcepath="src" splitindex="true" use="true" version="true" />
	</target>

	<target name="fresh-javadoc" depends="clean, src, src-x" />

</project>
